<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <title>Premier League Second Hand Ticket</title>
</head>
<body>
  <h1>Premier League Second Hand Ticket</h1>
  <input type="text" id="searchInput" placeholder="Search by Team">
  <button onclick="searchData()">Search</button>
  <form id="dataForm">
    <label for="home">Home Team:</label>
    <input type="text" id="home" name="home" required>

    <label for="away">Away Team:</label>
    <input type="text" id="away" name="away" required>

    <label for="price">Price:</label>
    <input type="number" id="price" name="price" required>

    <button type="submit">Add Ticket</button>
  </form>

  <table id="dataTable" border="1">
    <thead>
      <tr>
        <th>Home</th>
        <th>Away</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <script>
    async function fetchData() {
      const response = await fetch('/getData');
      const data = await response.json();
  
      const dataBody = document.getElementById('dataBody');
  
      
      while (dataBody.firstChild) {
        dataBody.removeChild(dataBody.firstChild);
      }
  
      data.forEach(item => {
        const row = document.createElement('tr');
        const cell1 = document.createElement('td');
        const cell2 = document.createElement('td');
        const cell3 = document.createElement('td');
  
        cell1.textContent = item.home;
        cell2.textContent = item.away;
        cell3.textContent = item.price;
  
        row.appendChild(cell1);
        row.appendChild(cell2);
        row.appendChild(cell3);
  
        dataBody.appendChild(row);
      });
    }
    async function searchData() {
    const searchInput = document.getElementById('searchInput').value;
    const response = await fetch(`/searchData?keyword=${searchInput}`);
    const data = await response.json();

    const dataBody = document.getElementById('dataBody');

    while (dataBody.firstChild) {
      dataBody.removeChild(dataBody.firstChild);
    }

    data.forEach(item => {
      const row = document.createElement('tr');
      const cell1 = document.createElement('td');
      const cell2 = document.createElement('td');
      const cell3 = document.createElement('td');

      cell1.textContent = item.home;
      cell2.textContent = item.away;
      cell3.textContent = item.price;

      row.appendChild(cell1);
      row.appendChild(cell2);
      row.appendChild(cell3);

      dataBody.appendChild(row);
    });
  }
    async function postData(data) {
      await fetch('/addData', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      });
  
      
      fetchData();
    }
  
    document.getElementById('dataForm').addEventListener('submit', function (event) {
      event.preventDefault();
  
      const formData = {
        home: document.getElementById('home').value,
        away: document.getElementById('away').value,
        price: document.getElementById('price').value,
      };
  
      postData(formData);
    });
  
    fetchData();
  </script>
</body>
</html>
